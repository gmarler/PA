<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>D3 FS Operations Heatmap Spike</title>
</head>

<style>
  body {
    font:    10px sans-serif;
  }

  .label {
    font-weight: bold;
  }

  .tile {
    shape-rendering: crispEdges;
  }

  .axis path,
  .axis line {
    fill:            none;
    stroke:          #000;
    shape-rendering: crispEdges;
  }
</style>
<body>

<script src="../../bower_components/d3/d3.min.js"></script>
<script src="../../bower_components/lodash/lodash.min.js"></script>
<script src="../../bower_components/moment/moment.js"></script>

<script>

var margin = {
  top:    20,
  right:  90,
  bottom: 30,
  left:   50
};

var width  = 960 - margin.left - margin.right;
var height = 700 - margin.top  - margin.bottom;

d3.json("../../data/iolat_heatmap_data.json", function(error, data) {
  if (error) return console.warn(error);
  // Data is in form:
  // [
  //   { timestamp: <seconds in UTC>,
  //     interval_data: [
  //       {
  //         "getpage:tmpfs":[[[10000,10999],1],[[12000,12999],1]],
  //       }
  //     ]
  //   },
  //   ...
  // ]
  //
  // Note that the DTrace that collects this data does so with the following llquantize() parameters:
  // llquantize(foo, 10, 3, 11, 100)
  // BASE/FACTOR: 10
  // LOW EXPONENT: 3
  // HIGH EXPONENT: 11
  // STEP:          100
  // Which will quantize from 10^3 through 10^12 - 1, with each range having 100 steps
  // So that's a possible range of 9 orders of magnitude, with 100 steps each, so our heatmap
  // could be, at most, 900 rectangles tall per time interval.
  //
  var ts = data.forEach(function(interval) {
    console.log(interval.timestamp);
    var interval_data = interval.interval_data;
    interval_data.forEach(function(hash) {
      // How to get key for each element?
      console.log(fsop_fstype);
    });
  });
//  d3.select("#chart")
//      .datum(data)
//      .call(flamegraph);
});

</script>

</body>
</html>