<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>D3 v4 Flamegraph Tests</title>
  <script src="https://d3js.org/d3.v4.min.js"></script>
</head>
<body>


  <!-- <script type="text/javascript" src="d3v4-flamegraph.js"></script> -->
  <script type="text/javascript" src="d3v4/d3.min.js"></script>
  <script type="text/javascript">
//    var flamegraph = d3.flameGraph()
//      .width(1024)
//      .height(768);

    d3.json("kernel-stack-simple.json", function(error, data) {
      if (error) return console.warn("WE DIED: " + error);
      console.log(data);
//      d3.select("#chart")
//        .data(data)
//        .call(flamegraph);
      var  width  = 1024;
      var height  = 768;

      // var xScale = d3.scale().range([width,height]).domain(0,1);

      var root = d3.hierarchy(data)
        .sum(function (d) { return d.children ? 0 : 1; })
        .sort(null);

      var partition = d3.partition()
        .size([height, width])
        .padding(0);

      partition(root);

      var nodes = svg.selectAll('rect')
          .data(root.descendants())
        .enter()
          .append('rect')
        .attr('fill', function(d) {
          return "purple";
        })
        .attr('stroke', 'black')
        .attr("x", function(d) { return d.y0; })
        .attr("y", function(d) { return d.x0; })
        .attr("width", function(d) { return d.y1 - d.y0; })
        .attr("height", function(d) { return d.x1 - d.x0; });

    });
  </script>

</body>
</html>